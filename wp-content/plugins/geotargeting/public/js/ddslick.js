!function(e){function t(e,t){d(e,e.find(".geotdd-option-value[value= '"+t+"']").parents("li").prevAll().length)}function d(e,t,d){void 0===d&&(d=!0);var i=e.data("ddslick"),s=e.find(".geotdd-selected"),l=s.siblings(".geotdd-selected-value"),a=(e.find(".geotdd-options"),s.siblings(".geotdd-pointer"),e.find(".geotdd-option").eq(t)),c=a.closest("li"),g=i.settings,r=i.settings.data[t];e.find(".geotdd-option").removeClass("geotdd-option-selected"),a.addClass("geotdd-option-selected"),i.selectedIndex=t,i.selectedItem=c,i.selectedData=r,g.showSelectedHTML?s.html((r.imageSrc?'<span class="'+r.imageSrc+" geotdd-selected-image"+("right"==g.imagePosition?" geotdd-image-right":"")+'"></span>':"")+(r.text?'<label class="geotdd-selected-text">'+r.text+"</label>":"")+(r.description?'<small class="geotdd-selected-description geotdd-desc'+(g.truncateDescription?" geotdd-selected-description-truncated":"")+'" >'+r.description+"</small>":"")):s.html(r.text),l.val(r.value),i.original.val(r.value),e.data("ddslick",i),o(e),n(e),d&&"function"==typeof g.onSelected&&g.onSelected.call(this,i)}function i(t){var d=t.find(".geotdd-select"),i=d.siblings(".geotdd-options"),o=d.find(".geotdd-pointer"),n=i.is(":visible");e(".geotdd-click-off-close").not(i).slideUp(50),e(".geotdd-pointer").removeClass("geotdd-pointer-up"),d.removeClass("geotdd-open"),n?(i.slideUp("fast"),o.removeClass("geotdd-pointer-up"),d.removeClass("geotdd-open")):(d.addClass("geotdd-open"),i.slideDown("fast"),o.addClass("geotdd-pointer-up")),s(t)}function o(e){e.find(".geotdd-select").removeClass("geotdd-open"),e.find(".geotdd-options").slideUp(50),e.find(".geotdd-pointer").removeClass("geotdd-pointer-up").removeClass("geotdd-pointer-up")}function n(e){e.find(".geotdd-select").css("height"),e.find(".geotdd-selected-description"),e.find(".geotdd-selected-image")}function s(t){t.find(".geotdd-option").each(function(){var d=e(this);d.css("height"),d.find(".geotdd-option-description"),t.find(".geotdd-option-image")})}e.fn.ddslick=function(t){return l[t]?l[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exists."):l.init.apply(this,arguments)};var l={},a={data:[],keepJSONItemsOnTop:!1,width:260,height:null,background:"#eee",selectText:"",defaultSelectedIndex:null,truncateDescription:!0,imagePosition:"left",showSelectedHTML:!0,clickOffToClose:!0,embedCSS:!0,onSelected:function(){}};l.init=function(t){e.extend({},a,t);return this.each(function(){var o=e.extend({},a,t),n=e(this);if(!n.data("ddslick")){c=[],o.data;n.find("option").each(function(){var t=e(this),d=t.data();c.push({text:e.trim(t.text()),value:t.val(),selected:t.is(":selected"),f:t.is(":selected"),description:d.description,imageSrc:d.imagesrc})}),o.keepJSONItemsOnTop?e.merge(o.data,c):o.data=e.merge(c,o.data);var s=n,l=e('<div id="'+n.attr("id")+'-geotdd-placeholder"></div>');n.replaceWith(l),(n=l).addClass("geotdd-container").append('<div class="geotdd-select"><input class="geotdd-selected-value" type="hidden" /><a class="geotdd-selected"></a><span class="geotdd-pointer geotdd-pointer-down"></span></div>').append('<ul class="geotdd-options"></ul>'),n.find("input.geotdd-selected-value").attr("id",e(s).attr("id")).attr("name",e(s).attr("name"));var c=n.find(".geotdd-select"),g=n.find(".geotdd-options");n.css({"max-width":o.width}),null!=o.height&&g.css({height:o.height,overflow:"auto"}),e.each(o.data,function(e,t){t.f&&(o.defaultSelectedIndex=e),g.append('<li><a class="geotdd-option">'+(t.value?' <input class="geotdd-option-value" type="hidden" value="'+t.value+'" />':"")+(t.imageSrc?' <span class="'+t.imageSrc+" geotdd-option-image"+("right"==o.imagePosition?" geotdd-image-right":"")+'"></span>':"")+(t.text?' <label class="geotdd-option-text">'+t.text+"</label>":"")+(t.description?' <small class="geotdd-option-description geotdd-desc">'+t.description+"</small>":"")+"</a></li>")});var r={settings:o,original:s,selectedIndex:-1,selectedItem:null,selectedData:null};if(n.data("ddslick",r),o.selectText.length>0&&null==o.defaultSelectedIndex)n.find(".geotdd-selected").html(o.selectText);else{var p=null!=o.defaultSelectedIndex&&o.defaultSelectedIndex>=0&&o.defaultSelectedIndex<o.data.length?o.defaultSelectedIndex:0;d(n,p,!1)}n.find(".geotdd-select").on("click.ddslick",function(){i(n)}),n.find(".geotdd-option").on("click.ddslick",function(){d(n,e(this).closest("li").index())}),o.clickOffToClose&&(g.addClass("geotdd-click-off-close"),n.on("click.ddslick",function(e){e.stopPropagation()}),e("body").on("click",function(){e(".geotdd-open").removeClass("geotdd-open"),e(".geotdd-click-off-close").slideUp(50).siblings(".geotdd-select").find(".geotdd-pointer").removeClass("geotdd-pointer-up")}))}})},l.select=function(i){return this.each(function(){void 0!==i.index&&d(e(this),i.index),i.id&&t(e(this),i.id)})},l.open=function(){return this.each(function(){var t=e(this);t.data("ddslick")&&i(t)})},l.close=function(){return this.each(function(){var t=e(this);t.data("ddslick")&&o(t)})},l.destroy=function(){return this.each(function(){var t=e(this),d=t.data("ddslick");if(d){var i=d.original;t.removeData("ddslick").unbind(".ddslick").replaceWith(i)}})}}(jQuery);